<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CasualMITEC Homepage</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background: #f8f9fa;
      color: #333;
    }
    header {
      background: #0056b3;
      color: white;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 1.8em;
    }
    section {
      max-width: 900px;
      margin: 30px auto;
      padding: 0 20px;
    }
    h2 {
      color: #0056b3;
      margin-bottom: 15px;
    }
    .quick-start, .quick-links, .announcements {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 25px;
    }
    .quick-start ol {
      padding-left: 20px;
    }
    .quick-links a {
      display: inline-block;
      margin: 10px 15px 10px 0;
      padding: 10px 20px;
      background: #0056b3;
      color: #fff;
      text-decoration: none;
      border-radius: 5px;
      transition: background 0.3s;
    }
    .quick-links a:hover {
      background: #003f7f;
    }
    .announcement-item {
      padding: 10px 0;
      border-bottom: 1px solid #ddd;
    }
    @media (max-width: 600px) {
      .quick-links a {
        margin: 5px 0;
        display: block;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>Welcome to CasualMITEC</h1>
  <p>Your guide to working at MITEC</p>
</header>

<section class="quick-start">
  <h2>Quick Start Guide</h2>
  <ol>
    <li>Register as a casual worker</li>
    <li>Apply for available shifts</li>
    <li>Get approved by your department</li>
    <li>Sign in & out when working</li>
    <li>Receive your payment</li>
  </ol>
</section>

<section class="announcements">
  <h2>Latest Announcements</h2>
  <div id="announcements">
    <p>Loading announcements...</p>
  </div>
</section>

<section class="quick-links">
  <h2>Quick Access</h2>
  <div id="links">
    <p>Loading links...</p>
  </div>
</section>

<script>
  // --- REPLACE THESE WITH YOUR ACTUAL SHEET IDS ---
  const announcementsSheetID = "1Gks45PK53pcPJXePjYlRLpAhAmGPMPB3X0ec5XaLgRI";
  const linksSheetID = "1HG6XoahHcLPkwsSH5MwY3I7f-iBX6OXtZX5F1-dyYkg";

  // --- FUNCTION TO FETCH GOOGLE SHEET AS JSON ---
  async function fetchSheetJSON(sheetId, sheetName="Sheet1") {
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
    const res = await fetch(url);
    const text = await res.text();
    const json = JSON.parse(text.substr(47).slice(0, -2));
    return json.table.rows;
  }

  // --- Load Announcements ---
  async function loadAnnouncements() {
    const container = document.getElementById("announcements");
    try {
      const rows = await fetchSheetJSON(announcementsSheetID);
      container.innerHTML = "";
      if (rows.length === 0) {
        container.innerHTML = "<p>No announcements at the moment.</p>";
        return;
      }
      rows.forEach(row => {
        const item = document.createElement("div");
        item.className = "announcement-item";
        item.textContent = row.c[0] ? row.c[0].v : "";
        container.appendChild(item);
      });
    } catch (err) {
      container.innerHTML = "<p>Unable to load announcements.</p>";
      console.error(err);
    }
  }

  // --- Load Quick Links ---
  async function loadQuickLinks() {
    const container = document.getElementById("links");
    try {
      const rows = await fetchSheetJSON(linksSheetID);
      container.innerHTML = "";
      if (rows.length === 0) {
        container.innerHTML = "<p>No links available.</p>";
        return;
      }
      rows.forEach(row => {
        const a = document.createElement("a");
        a.href = row.c[1] ? row.c[1].v : "#";
        a.textContent = row.c[0] ? row.c[0].v : "Link";
        a.target = "_blank";
        container.appendChild(a);
      });
    } catch (err) {
      container.innerHTML = "<p>Unable to load links.</p>";
      console.error(err);
    }
  }

  // --- Initialize ---
  loadAnnouncements();
  loadQuickLinks();
</script>

</body>
</html>
